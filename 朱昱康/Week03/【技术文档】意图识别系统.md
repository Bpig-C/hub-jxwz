# 意图识别系统技术设计文档

## 项目概述

本项目是一个多模型融合的意图识别系统，提供 RESTful API 服务，支持 4 种不同的意图分类方法。系统能够识别 12 种意图类别：TravelQuery、MusicPlay、FilmTelePlay、VideoPlay、RadioListen、HomeApplianceControl、WeatherQuery、AlarmUpdate、CalendarQuery、TVProgramPlay、AudioPlay、Other。

## 系统架构

### 核心组件

- **API 服务层**：基于 FastAPI 构建，提供 4 个分类接口
- **模型层**：4 种不同的意图分类模型
- **数据层**：支持在线数据集加载和本地模型权重加载（待实现）

### API 接口设计

| 接口路径             | 方法 | 描述              | 响应时间（预估） |
| -------------------- | ---- | ----------------- | ---------------- |
| `/v1/text-cls/regex` | POST | 正则规则分类      | ~xxx s          |
| `/v1/text-cls/tfidf` | POST | TF-IDF+SVM 分类   | ~xxx s           |
| `/v1/text-cls/bert`  | POST | BERT 深度学习分类 | ~xxx s            |
| `/v1/text-cls/gpt`   | POST | 大语言模型分类    | ~xxx s            |

## 四种模型详细分析

### 1. 正则匹配模型

**技术实现**：

- 基于预定义的正则表达式规则进行模式匹配
- 使用 Python `re` 模块实现高效文本匹配

**优点**：

- **速度快**：响应极快，可满足高并发场景
- **无硬件要求**：无需 GPU/大内存，有 CPU 即可运行
- **无训练要求**：无需训练数据即可使用

**缺点**：

- **覆盖率低**：只能识别预定义模式，无学习能力
- **维护成本高**：需要人工编写和维护大量规则
- **准确率有限**：在复杂语境下容易误判

### 2. TF-IDF + SVM 传统 ML 模型

**技术实现**：

- 使用 jieba，进行文本预处理
- 使用 TF-IDF 特征提取
- 使用 LinearSVM 做分类器
- 支持批量预测和在线学习（待实现）

**优点**：

- **平衡性能和表现**：在准确率和速度间取得良好平衡
- **资源友好**：模型体积小（相对语言模型），推理速度快
- **稳定性较高**：能保持较高准确度，同时也有一定泛化能力

**缺点**：

- **特征稀疏**：稀疏矩阵对未见过的词汇组合处理能力弱
- **语义理解能力缺失**：无法理解上下文和深层语义

### 3. BERT 深度学习模型

**技术实现**：

- 基于 MacBERT-base 预训练模型
- 序列分类任务微调（12 类多分类）
- 最大序列长度 30，批量大小 16

**优点**：

- **语义理解**：能理解上下文和隐含意图
- **泛化能力较强**：对未见过的表达模式有较好适应性
- **端到端**：无需复杂的特征提取工程（对比TF-IDF+SVM）

**缺点**：

- **对资源有要求**：模型体积较大，且可能需要 GPU 来加速计算
- **推理速度**：单次推理约 xxx ms
- **黑盒特性**：端到端带来的缺点，决策过程不透明，难以直接调试

### 4. 大语言模型 (GPT-based)

**技术实现**：

- 基于 Qwen2.5-3B-Instruct 模型（待最终选定）
- 利用（动态）提示词工程强化上下文理解

**优点**：

- **泛化能力很强**：具有很强的语意理解能力，几乎能处理任何语言表达形式
- **上下文学习**：能通过示例和提示词快速适应
- **易改进**：可通过更换模型，提示词工程，RAG等手段提升模型能力

**缺点**：

- **成本最高**：API 调用费用或本地部署成本
- **延迟最大**：单次调用 xxx 秒
- **结果不稳定**：有可能产生幻觉或不一致输出
- **依赖外部服务**：需要稳定的模型API服务支持

**创新点**：动态示例选择机制，基于 TF-IDF 相似度检索最相关训练样本

## 模型选择策略


### 性能对比（具体数据待填写）

| 指标     | 正则 | TF-IDF | BERT  | GPT    |
| -------- | ---- | ------ | ----- | ------ |
| 准确率   | ~xxx % | ~xxx %   | ~xxx %  | ~xxx %   |
| 延迟     | xxx ms | xxx ms   | xxx ms | xxx ms |
| 资源消耗 | 最低 | 低     | 高    | 最高   |
| 维护成本 | 高   | 中     | 低    | 低   |

### 生产环境配置（可选）

- **高并发场景**：正则+TF-IDF 组合（95%请求）
- **精准度优先**：BERT 为主，GPT 为辅（5%复杂请求）
- **动态选择**：可利用业务网关层，根据业务场景动态路由到不同模型的服务
